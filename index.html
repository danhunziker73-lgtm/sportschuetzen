<!DOCTYPE html>1,2
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">

<title>Jahresmeisterschaft 2025</title>

<!-- PWA -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0f3a5d">
<link rel="apple-touch-icon" href="icons/apple-touch-icon.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">

<style>
:root{--primary:#0f3a5d;--bg:#f6f7f8;--text:#333;--accent:#e74c3c}
body{font-family:system-ui,-apple-system,sans-serif;background:var(--bg);margin:0;padding:20px;color:var(--text)}
h1{margin-bottom:5px}
.subtitle{color:#666;margin-bottom:30px}
.liga{margin-bottom:40px}
table{width:100%;border-collapse:collapse;background:#fff;box-shadow:0 4px 12px rgba(0,0,0,.08);border-radius:8px;overflow:hidden;table-layout:fixed}
thead{background:var(--primary);color:#fff}
th,td{padding:12px 15px;text-align:left;border-bottom:1px solid #eee;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.col-rang{width:60px}.col-jg{width:80px}.col-total{width:100px}.col-zusatz{width:120px}
.clickable{cursor:pointer}.clickable:hover{background:#f0f4f8}
.details{display:none;background:#fdfdfd}.details td{white-space:normal}
.detail-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:25px;padding:20px;border-top:2px solid var(--primary)}
.detail-box h4{margin:0 0 10px;padding-bottom:5px;border-bottom:2px solid #ddd;color:var(--primary);display:flex;justify-content:space-between}
.detail-box ul{list-style:none;padding:0;margin:0}
.detail-box li{display:flex;align-items:baseline;padding:4px 0;font-size:.95rem}
.item-name{flex-shrink:0}
.item-dots{flex-grow:1;border-bottom:1px dotted #ccc;margin:0 8px;position:relative;top:-4px}
.item-value{flex-shrink:0;font-weight:600;font-variant-numeric:tabular-nums}
.prz-small{color:#666;font-size:.85rem;margin-left:4px}
.streich-info{background:#fff0f0;padding:8px;border-radius:4px;border-left:4px solid var(--accent);margin-top:15px;font-size:.9rem;font-weight:600}
.is-streich{color:var(--accent);text-decoration:line-through;opacity:.7}
.badge-auswaerts{background:#e8f5e9;color:#2e7d32;padding:2px 6px;border-radius:4px;font-size:.75rem;font-weight:bold}
.aufsteiger{border-left:5px solid #2ecc71;background:#fafffa}
.absteiger{border-left:5px solid #e74c3c;background:#fffaf9}
.status-label{font-size:.65rem;font-weight:bold;text-transform:uppercase;display:block;margin-top:2px}
.text-auf{color:#27ae60}.text-ab{color:#c0392b}
.error-box{background:#fff0f0;border-left:5px solid #e74c3c;padding:15px;border-radius:6px}

.app-bottom-nav {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  height: 64px;
  background: #0f3a5d;
  display: flex;
  justify-content: space-around;
  align-items: center;
  box-shadow: 0 -4px 12px rgba(0,0,0,.25);
  z-index: 999;
}

.app-bottom-nav a {
  color: #cbd5e1;
  text-decoration: none;
  font-size: 0.75rem;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
}

.app-bottom-nav a span {
  font-size: 0.65rem;
}

.app-bottom-nav a.active {
  color: #ffffff;
  font-weight: 600;
}

body {
  padding-bottom: 80px; /* Platz f√ºr Nav */
}





  
</style>
</head>

<body>
<nav class="app-bottom-nav">
  <a href="index.html">üè†<span>√úbersicht</span></a>
  <a href="jm.html" class="active">üèÜ<span>JM</span></a>
  <a href="mm.html">üë•<span>MM</span></a>
  <a href="gm.html">üéØ<span>GM</span></a>
  <a href="upload.html">üì∑<span>Upload</span></a>
</nav>


  
<h1>Jahresmeisterschaft 2025</h1>
<div class="subtitle">Tippen Sie auf einen Sch√ºtzen f√ºr die Detailauswertung</div>
<div id="content">Lade Daten‚Ä¶</div>

<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("sw.js");
}
</script>

<script>
(function(){
  var API_URL="https://jahresmeisterschaft-muhen.dan-hunziker73.workers.dev";

  function formatNum(v){var n=Number(v);return isFinite(n)?n.toFixed(2):"0.00";}
  function safeArray(v){return Object.prototype.toString.call(v)==="[object Array]"?v:[];}

  window.toggle = function (id) {
  const el = document.getElementById(id);
  if (!el) return;

  // alle Details schliessen
  const rows = document.querySelectorAll(".details");
  rows.forEach(r => r.style.display = "none");

  // aktuelles toggeln
  const isHidden = el.style.display === "" || el.style.display === "none";
  el.style.display = isHidden ? "table-row" : "none";
};
 

  function renderLiga(ligaNr,raw){
    var teilnehmer=safeArray(raw);
    var html='<div class="liga"><h2>Liga '+ligaNr+'</h2><table><thead><tr>'+
      '<th class="col-rang">Rang</th><th>Name</th><th class="col-jg">Jg.</th>'+
      '<th class="col-total">Total</th><th class="col-zusatz">Zusatz</th>'+
      '</tr></thead><tbody>';

    for(var i=0;i<teilnehmer.length;i++){
      var t=teilnehmer[i]||{};
      var au=safeArray(t.auswaerts);
      var id="l"+ligaNr+"_"+i;

      html+='<tr class="clickable" onclick="toggle(\''+id+'\')">'+
        '<td><b>'+(t.rang||"-")+'</b></td>'+
        '<td>'+(t.name||"-")+'</td>'+
        '<td>'+(t.jahrgang||"-")+'</td>'+
        '<td><b>'+formatNum(t.total)+'</b></td>'+
        '<td>'+(au.length?'<span class="badge-auswaerts">'+au.length+' Ausw√§rts</span>':"")+'</td></tr>';

      html+='<tr id="'+id+'" class="details"><td colspan="5"><div class="detail-grid">Details siehe Web-Version</div></td></tr>';
    }
    return html+'</tbody></table></div>';
  }

  fetch(API_URL)
    .then(r=>r.json())
    .then(d=>{
      document.getElementById("content").innerHTML=
        renderLiga(1,d.liga1)+renderLiga(2,d.liga2);
    })
    .catch(()=>{
      document.getElementById("content").innerHTML=
        '<div class="error-box"><b>Fehler beim Laden</b></div>';
    });
})();
</script>
</body>
</html>
